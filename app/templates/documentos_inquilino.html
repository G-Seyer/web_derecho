<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Subir documentos ‚Äì Inquilino</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='estilos.css') }}?v=3">
</head>
<body>
<header class="barra-superior solid">
  <div class="menu-links" id="menu">
    <a href="/">Inicio</a>
    <a href="/#servicios">Servicios</a>
    <a href="/contacto">Contacto</a>
  </div>
</header>

<div class="container page-docs py-4">
  <h1 class="mb-4">Subir documentos ‚Äì Inquilino (Arrendatario)</h1>

  <form method="POST" action="{{ url_for('main.subir_inquilino') }}" enctype="multipart/form-data" id="form-inquilino">
    <div class="row g-3 mb-3">
      <div class="col-md-6">
        <label class="form-label">Nombre completo</label>
        <input type="text" name="nombre" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label class="form-label">Correo electr√≥nico</label>
        <input type="email" name="correo" class="form-control" required>
        <div class="form-text">
          Usa un correo <code>@gmail.com</code>. Te avisaremos si falta ‚Äú@gmail.com‚Äù.
        </div>
      </div>
    </div>

    <!-- Direcci√≥n del inmueble (una sola l√≠nea) -->
    <div class="mb-3">
      <label class="form-label">Direcci√≥n del inmueble</label>
      <input type="text" name="direccion" class="form-control"
             placeholder="Calle N√∫mero Colonia (en ese orden)"
             required
             pattern="^\s*\S+(?:\s+\S+)*\s+\d+[\w/-]*\s+\S+(?:\s+\S+)*\s*$">
      <div class="form-text">
        Escribe la <strong>direcci√≥n del inmueble</strong> en el orden:
        <em>Calle N√∫mero Colonia</em>. Ejemplo: <code>Insurgentes Sur 716 Del Valle</code>.
      </div>
    </div>

    <div class="doc-grid">
      <div class="doc-card" data-field="identificacion">
        <div class="doc-emoji">ü™™</div>
        <div class="doc-title">Identificaci√≥n oficial</div>
        <div class="doc-upload">
          <input id="id_inq" type="file" name="identificacion" accept=".pdf,image/*" required>
          <label for="id_inq">Seleccionar archivo</label>
        </div>
        <div class="doc-file small text-secondary mt-1">Sin archivo</div>
        <div class="doc-status mt-2"><span class="doc-dot"></span><span class="doc-text">Pendiente</span></div>
      </div>

      <div class="doc-card" data-field="comprobante_domicilio">
        <div class="doc-emoji">üè†</div>
        <div class="doc-title">Comprobante de domicilio</div>
        <div class="doc-upload">
          <input id="dom_inq" type="file" name="comprobante_domicilio" accept=".pdf,image/*" required>
          <label for="dom_inq">Seleccionar archivo</label>
        </div>
        <div class="doc-file small text-secondary mt-1">Sin archivo</div>
        <div class="doc-status mt-2"><span class="doc-dot"></span><span class="doc-text">Pendiente</span></div>
      </div>

      <div class="doc-card" data-field="comprobante_ingresos">
        <div class="doc-emoji">üí∞</div>
        <div class="doc-title">Comprobante de ingresos</div>
        <div class="doc-upload">
          <input id="ing_inq" type="file" name="comprobante_ingresos" accept=".pdf,image/*" required>
          <label for="ing_inq">Seleccionar archivo</label>
        </div>
        <div class="doc-file small text-secondary mt-1">Sin archivo</div>
        <div class="doc-status mt-2"><span class="doc-dot"></span><span class="doc-text">Pendiente</span></div>
      </div>

      <div class="doc-card" data-field="solicitud_arrendamiento">
        <div class="doc-emoji">üìù</div>
        <div class="doc-title">Solicitud de arrendamiento</div>
        <div class="doc-upload">
          <input id="sol_inq" type="file" name="solicitud_arrendamiento" accept=".pdf,image/*" required>
          <label for="sol_inq">Seleccionar archivo</label>
        </div>
        <div class="doc-file small text-secondary mt-1">Sin archivo</div>
        <div class="doc-status mt-2"><span class="doc-dot"></span><span class="doc-text">Pendiente</span></div>
      </div>

      <div class="doc-card" data-field="aval">
        <div class="doc-emoji">üßæ</div>
        <div class="doc-title">Aval (documentaci√≥n)</div>
        <div class="doc-upload">
          <input id="aval_inq" type="file" name="aval" accept=".pdf,image/*" required>
          <label for="aval_inq">Seleccionar archivo</label>
        </div>
        <div class="doc-file small text-secondary mt-1">Sin archivo</div>
        <div class="doc-status mt-2"><span class="doc-dot"></span><span class="doc-text">Pendiente</span></div>
      </div>
    </div>

    <div class="mt-4">
      <button id="btn-inquilino" class="btn btn-primary" disabled>Enviar documentos</button>
      <a href="/" class="btn btn-secondary ms-2">Cancelar</a>
    </div>
  </form>
</div>

<script>
  (function(){
    const form = document.getElementById('form-inquilino');
    const email = form.querySelector('input[name="correo"]');
    const dir = form.querySelector('input[name="direccion"]');

    function validaGmail() {
      if (!/@gmail\.com\s*$/i.test(email.value.trim())) {
        email.setCustomValidity('El correo debe ser @gmail.com');
      } else {
        email.setCustomValidity('');
      }
    }
    function validaDireccion() {
      if (!dir.checkValidity()) {
        dir.setCustomValidity('Formato: Calle N√∫mero Colonia (en ese orden)');
      } else {
        dir.setCustomValidity('');
      }
    }

    email.addEventListener('input', validaGmail);
    dir.addEventListener('input', validaDireccion);
  })();
</script>

<script>
(function(){
  const form = document.getElementById('form-inquilino');
  const inputs = Array.from(form.querySelectorAll('.doc-card input[type="file"][required]'));
  const btn = document.getElementById('btn-inquilino');

  function shortName(name){
    if(!name) return "Sin archivo";
    return name.length > 38 ? name.slice(0,18) + "‚Ä¶" + name.slice(-16) : name;
  }
  function updateCard(input){
    const card = input.closest('.doc-card');
    const ok = input.files && input.files.length > 0;
    card.classList.toggle('ok', ok);
    card.querySelector('.doc-text').textContent = ok ? 'Listo' : 'Pendiente';
    const fn = card.querySelector('.doc-file');
    if(fn) fn.textContent = ok ? shortName(input.files[0].name) : 'Sin archivo';
  }
  function reevaluate(){ btn.disabled = !inputs.every(i => i.files && i.files.length > 0); }

  inputs.forEach(i => { i.addEventListener('change', ()=>{ updateCard(i); reevaluate(); }); updateCard(i); });
  reevaluate();
})();
</script>

<script>
(function(){
  const header = document.querySelector('.barra-superior'); if(!header) return;
  const set = () => document.documentElement.style.setProperty('--header-h', header.offsetHeight + 'px');
  set(); window.addEventListener('resize', set);
})();
</script>
</body>
</html>
